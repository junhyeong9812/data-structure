# 17. íœìœ… íŠ¸ë¦¬ (Fenwick Tree / Binary Indexed Tree)

## ğŸ“‹ ë¬¸ì œ ì •ì˜

**ë¹„íŠ¸ ì¡°ì‘**ì„ í™œìš©í•˜ì—¬ ëˆ„ì  í•©(Prefix Sum)ì„ íš¨ìœ¨ì ìœ¼ë¡œ ê³„ì‚°í•˜ëŠ” íœìœ… íŠ¸ë¦¬ë¥¼ êµ¬í˜„í•˜ì„¸ìš”.

íœìœ… íŠ¸ë¦¬ëŠ” ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ë³´ë‹¤ êµ¬í˜„ì´ ê°„ë‹¨í•˜ê³  ë©”ëª¨ë¦¬ë¥¼ ì ê²Œ ì‚¬ìš©í•˜ë©´ì„œë„
ì  ì—…ë°ì´íŠ¸ì™€ êµ¬ê°„ í•© ì¿¼ë¦¬ë¥¼ O(log n)ì— ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸ¯ í•™ìŠµ ëª©í‘œ

- íœìœ… íŠ¸ë¦¬ì˜ êµ¬ì¡°ì™€ ì›ë¦¬
- ë¹„íŠ¸ ì¡°ì‘ì„ í†µí•œ ì¸ë±ìŠ¤ ê³„ì‚°
- LSB(Least Significant Bit) í™œìš©
- ì  ì—…ë°ì´íŠ¸ì™€ êµ¬ê°„ ì¿¼ë¦¬
- ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ì™€ì˜ ë¹„êµ

---

## ğŸ“ ìš”êµ¬ì‚¬í•­

### ê¸°ë³¸ ì—°ì‚°

| ë©”ì„œë“œ | ì„¤ëª… | ì‹œê°„ë³µì¡ë„ |
|--------|------|-----------|
| `update(i, delta)` | ië²ˆì§¸ ì›ì†Œì— delta ë”í•˜ê¸° | O(log n) |
| `query(i)` | [1, i] êµ¬ê°„ í•© (prefix sum) | O(log n) |
| `rangeQuery(l, r)` | [l, r] êµ¬ê°„ í•© | O(log n) |
| `get(i)` | ië²ˆì§¸ ì›ì†Œ ê°’ | O(log n) |

### ì¶”ê°€ ì—°ì‚°

| ë©”ì„œë“œ | ì„¤ëª… |
|--------|------|
| `set(i, value)` | ië²ˆì§¸ ì›ì†Œë¥¼ valueë¡œ ì„¤ì • |
| `build(arr)` | ë°°ì—´ë¡œ íŠ¸ë¦¬ êµ¬ì¶• |
| `findKth(k)` | ëˆ„ì  í•©ì´ k ì´ìƒì¸ ìµœì†Œ ì¸ë±ìŠ¤ |

---

## ğŸ“Š ì…ì¶œë ¥ ì˜ˆì‹œ

### ì˜ˆì œ 1: ê¸°ë³¸ ì‚¬ìš©
```java
int[] arr = {0, 1, 2, 3, 4, 5};  // 1-indexed (0ë²ˆì€ ë¯¸ì‚¬ìš©)

FenwickTree tree = new FenwickTree(arr);

// êµ¬ê°„ í•© ì¿¼ë¦¬
System.out.println(tree.query(3));      // 1+2+3 = 6
System.out.println(tree.query(5));      // 1+2+3+4+5 = 15
System.out.println(tree.rangeQuery(2, 4)); // 2+3+4 = 9

// ì  ì—…ë°ì´íŠ¸
tree.update(3, 7);  // arr[3] += 7 â†’ arr[3] = 10

System.out.println(tree.query(3));      // 1+2+10 = 13
System.out.println(tree.rangeQuery(2, 4)); // 2+10+4 = 16
```

### ì˜ˆì œ 2: ë¹„íŠ¸ ì—°ì‚° ì‹œê°í™”
```
ì¸ë±ìŠ¤ì™€ ë‹´ë‹¹ ë²”ìœ„ (n=8):

idx  binary   ë²”ìœ„         ë‹´ë‹¹ ì›ì†Œ
1    0001     [1,1]        arr[1]
2    0010     [1,2]        arr[1..2]
3    0011     [3,3]        arr[3]
4    0100     [1,4]        arr[1..4]
5    0101     [5,5]        arr[5]
6    0110     [5,6]        arr[5..6]
7    0111     [7,7]        arr[7]
8    1000     [1,8]        arr[1..8]

tree[i]ê°€ ë‹´ë‹¹í•˜ëŠ” ë²”ìœ„ì˜ ê¸¸ì´ = LSB(i)
```

### ì˜ˆì œ 3: ì¿¼ë¦¬ ê³¼ì •
```
query(7) ê³„ì‚° ê³¼ì •:

7 = 0111 â†’ tree[7] (ë²”ìœ„ [7,7])
6 = 0110 â†’ tree[6] (ë²”ìœ„ [5,6])
4 = 0100 â†’ tree[4] (ë²”ìœ„ [1,4])
0 = ì¢…ë£Œ

ê²°ê³¼: tree[7] + tree[6] + tree[4]
    = arr[7] + (arr[5]+arr[6]) + (arr[1]+arr[2]+arr[3]+arr[4])
    = arr[1..7]ì˜ í•©
```

### ì˜ˆì œ 4: ì—…ë°ì´íŠ¸ ê³¼ì •
```
update(3, delta) ê³¼ì •:

3 = 0011 â†’ tree[3] += delta
4 = 0100 â†’ tree[4] += delta
8 = 1000 â†’ tree[8] += delta
... (n ì´ˆê³¼í•˜ë©´ ì¢…ë£Œ)

3ì„ í¬í•¨í•˜ëŠ” ëª¨ë“  êµ¬ê°„ ì—…ë°ì´íŠ¸
```

---

## ğŸ” í•µì‹¬ ê°œë…

### LSB (Lowest Set Bit)
```java
// iì˜ ê°€ì¥ ë‚®ì€ 1ë¹„íŠ¸ ì¶”ì¶œ
int lsb = i & (-i);

ì˜ˆ:
12 = 1100 â†’ LSB = 0100 = 4
10 = 1010 â†’ LSB = 0010 = 2
8  = 1000 â†’ LSB = 1000 = 8
7  = 0111 â†’ LSB = 0001 = 1
```

### ì¿¼ë¦¬ (prefix sum)
```
iì—ì„œ ì‹œì‘í•˜ì—¬ LSBë¥¼ ë¹¼ë©´ì„œ ì´ë™
7 â†’ 6 â†’ 4 â†’ 0 (ì¢…ë£Œ)
```

### ì—…ë°ì´íŠ¸
```
iì—ì„œ ì‹œì‘í•˜ì—¬ LSBë¥¼ ë”í•˜ë©´ì„œ ì´ë™
3 â†’ 4 â†’ 8 â†’ 16 â†’ ... (n ì´ˆê³¼ ì‹œ ì¢…ë£Œ)
```

---

## ğŸ’¡ íŒíŠ¸

### ê¸°ë³¸ êµ¬ì¡°
```java
public class FenwickTree {
    private long[] tree;
    private int n;
    
    public FenwickTree(int n) {
        this.n = n;
        this.tree = new long[n + 1];  // 1-indexed
    }
}
```

### LSB ê³„ì‚°
```java
private int lsb(int i) {
    return i & (-i);
}
```

### ì¿¼ë¦¬ (Prefix Sum)
```java
public long query(int i) {
    long sum = 0;
    while (i > 0) {
        sum += tree[i];
        i -= lsb(i);  // LSB ë¹¼ê¸°
    }
    return sum;
}
```

### ì—…ë°ì´íŠ¸
```java
public void update(int i, long delta) {
    while (i <= n) {
        tree[i] += delta;
        i += lsb(i);  // LSB ë”í•˜ê¸°
    }
}
```

### êµ¬ê°„ ì¿¼ë¦¬
```java
public long rangeQuery(int l, int r) {
    return query(r) - query(l - 1);
}
```

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] ê¸°ë³¸ update, query êµ¬í˜„
- [ ] rangeQuery êµ¬í˜„
- [ ] set (ê°’ ì„¤ì •) êµ¬í˜„
- [ ] build (ë°°ì—´ë¡œ êµ¬ì¶•) êµ¬í˜„
- [ ] get (ê°œë³„ ê°’ ì¡°íšŒ) êµ¬í˜„
- [ ] 2D íœìœ… íŠ¸ë¦¬ (ì„ íƒ)
- [ ] findKth êµ¬í˜„ (ì„ íƒ)

---

## ğŸ“š ì°¸ê³ 

- Binary Indexed Tree (BIT)ë¼ê³ ë„ ë¶ˆë¦¼
- ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ë³´ë‹¤ êµ¬í˜„ ê°„ë‹¨, ë©”ëª¨ë¦¬ íš¨ìœ¨ì 
- ì—­ìˆ˜ ì¹´ìš´íŒ…, êµ¬ê°„ í•© ë¬¸ì œì— ìì£¼ ì‚¬ìš©
- [Fenwick Tree Visualization](https://visualgo.net/en/fenwicktree)
